<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>vimwiki</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="../../../wikicss.css" />
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<h1 id="vimwiki">vimwiki</h1>
<h2 id="介绍">介绍</h2>
<p>主页：https://github.com/vimwiki/vimwiki</p>
<h2 id="安装">安装</h2>
<p>使用了 Vundle 安装</p>
<h2 id="使用">使用</h2>
<ul>
<li>打开wiki</li>
<li>转换当前页面为HTML</li>
<li>转换并在浏览器打开</li>
</ul>
<h2 id="感受">感受</h2>
<ul>
<li>顺畅方便</li>
<li>输出到HTML迅速清晰，便于整理</li>
<li>多记录</li>
</ul>
<h2 id="markdown支持">markdown支持</h2>
<p>修改 vimrc ，加入如下内容：</p>
<pre><code>let g:vimwiki_list = [{&#39;path&#39;: &#39;~/vimwiki/&#39;, &quot;维基目录
  \ &#39;path_html&#39;: &#39;~/vimwikihtml&#39;, &quot;输出HTML目录
  \ &#39;syntax&#39;: &#39;markdown&#39;,
  \ &#39;ext&#39;: &#39;.md&#39;,
  \ &#39;custom_wiki2html&#39;: &#39;~/.vim/vimwiki2html.py&#39;}] &quot;自定义转换脚本

&quot; 快捷键生成HTML
map &lt;S-F4&gt; :VimwikiAll2HTML&lt;cr&gt;
map &lt;F4&gt; :Vimwiki2HTML&lt;cr&gt;
</code></pre>
<p>默认不支持markdown格式转换，用<a href="https://github.com/vimwiki/vimwiki/blob/master/autoload/vimwiki/customwiki2html.sh">官方的脚本</a>不能转换页面内md文件链接</p>
<p>用自定义脚本，需要：</p>
<ul>
<li>安装 pandoc</li>
<li>vimwiki2html.py 需要 chmod+x 可执行</li>
<li>脚本地址：https://github.com/vimwiki/vimwiki/issues/642</li>
</ul>
<h2 id="美化">美化</h2>
<p>可以修改上面py文件，pandoc可以指定css文件，但只能用绝对地址，只测试了本地使用。</p>
<h2 id="转换脚本">转换脚本</h2>
<pre><code>#!/usr/bin/env python3

from os import path
import re
import shutil
import subprocess
import sys
import tempfile


def convert(
    force,
    syntax,
    extension,
    output_dir,
    input_file,
    css_file,
    template_path,
    template_default,
    template_ext,
    root_path,
    custom_args,
):
    if shutil.which(&quot;pandoc&quot;) is None:
        print(&quot;Error: pandoc not found&quot;, file=sys.stderr)
        sys.exit(1)

    if syntax != &quot;markdown&quot;:
        print(&quot;Error: Unsupported syntax&quot;, file=sys.stderr)
        sys.exit(1)

    input_file_name = path.splitext(path.basename(input_file))[0]
    output_file = path.join(output_dir, input_file_name) + path.extsep + &quot;html&quot;

    with open(input_file, &quot;r&quot;, encoding=&quot;utf8&quot;) as f:
        lines = f.read()

    lines = re.sub(r&quot;\[([^]]+)\]\((.+)\)&quot;, repl, lines)

    # Look for title in metadata
    match = re.search(
        &quot;^(?:---|\.\.\.)$\n.*title: ([^\n]+)$\n.*^(?:---|\.\.\.)$&quot;,
        lines,
        re.MULTILINE | re.DOTALL,
    )
    title = match.group(1) if match else input_file_name.title()

    template = path.join(template_path, template_default + path.extsep + template_ext)
    command = [
        &quot;pandoc&quot;,
        &quot;--section-divs&quot;,
        &quot;--template={}&quot;.format(template) if path.isfile(template) else &quot;&quot;,
        &quot;-s&quot;,
        &quot;-c /home/laodu/vimwikihtml/style.css&quot;,
        &quot;--highlight-style=pygments&quot;,
        &quot;--metadata&quot;,
        &quot;pagetitle={}&quot;.format(title),
        custom_args if custom_args != &quot;-&quot; else &quot;&quot;,
        &quot;-f&quot;,
        &quot;markdown&quot;,
        &quot;-t&quot;,
        &quot;html&quot;,
        &quot;-o&quot;,
        output_file,
        &quot;-&quot;,
    ]

    # Prune empty elements from command list
    command = list(filter(None, command))

    # Run command
    subprocess.run(command, check=True, encoding=&quot;utf8&quot;, input=lines)


def repl(match):
    link = path.splitext(match.group(2))[0] + &quot;.html&quot;
    return &quot;[{}]({})&quot;.format(match.group(1), link)


if __name__ == &quot;__main__&quot;:
    convert(*sys.argv[1:])

</code></pre>
<hr />
<p>参考链接： - https://xbeta.info/vimwiki.htm</p>
<hr />
<p>20201207 创建 20201208 更新</p>
</body>
</html>
